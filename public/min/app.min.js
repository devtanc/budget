angular.module("budgetApp",["ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"/temps/frontPage.temp.html",controller:"FrontPageController"}).when("/viewAll",{templateUrl:"/temps/all.temp.html",controller:"ViewAllPageController"}).when("/edit/:recurrence/:creationDate",{templateUrl:"/temps/edit.temp.html",controller:"EditPageController"}).when("/createNew",{templateUrl:"/temps/new.temp.html",controller:"CreationController"})}]);var budgetApp=angular.module("budgetApp");budgetApp.controller("FrontPageController",["$scope","$location","$http","expensesService",function(e,t,n,a){e.goTo=function(e){t.path(e)},a.refreshExpenses().then(function(){a.getFilteredExpenses().then(function(t){e.expenses=t.expenses,e.paycheckStart=new Date(t.paycheckStart),e.paycheckEnd=new Date(t.paycheckEnd),n.get("/api/getExpense/system/paycheck-actuals").then(function(t){e.remainingPay=t.data.Item.leftoverAmt,e.netPay=t.data.Item.paycheckAmt,e.recalculateTotal()})})}),e.updatePaycheck=function(){var t=moment(e.paycheckStart).format("YYYY-MM-DD");a.getFilteredExpenses(t).then(function(t){e.expenses=t.expenses,e.paycheckStart=t.paycheckStart,e.paycheckEnd=t.paycheckEnd,e.recalculateTotal()})},e.recalculateTotal=function(){e.total=e.expenses.reduce(function(e,t){return e+parseFloat(t.amount)},parseFloat(e.expenses[0].amount)),e.total-=e.remainingPay}}]),budgetApp.controller("ViewAllPageController",["$scope","$location","expensesService",function(e,t,n){e.goTo=function(e,n,a){"edit"===e?t.path(e+"/"+n+"/"+encodeURIComponent(a)):t.path(e)},n.getExpenses().then(function(t){e.expenses=t})}]),budgetApp.controller("EditPageController",["$scope","$location","$http","$routeParams","expensesService","schemas",function(e,t,n,a,o,r){var c=a.recurrence,l=a.creationDate;e.goTo=function(e){t.path(e)},e.globalFields=r.getSchema("globalFields"),e.recurrenceTypes=r.getSchema("recurrenceTypes"),e.calculatedFields=r.getCalculatedFields(c),o.getExpense(c,decodeURIComponent(l)).then(function(t){e.expense=t||null}).catch(function(e){console.error(e)}),e.updateFields=function(){e.calculatedFields=r.getCalculatedFields(e.expense.recurrence)},e.deleteExpense=function(){n({method:"DELETE",url:"/api/deleteExpense",headers:{"Content-Type":"application/json"},data:{primary:c,secondary:decodeURIComponent(l)}}).then(function(){o.refreshExpenses().then(function(){e.goTo("/viewAll")})}).catch(function(e){console.error(e)})},e.updateExpense=function(){if(c!==e.expense.recurrence){var t={recurrence:e.expense.recurrence,creationDate:l};e.globalFields.forEach(function(n){t[n.name]=e.expense[n.name]}),e.calculatedFields.fields.forEach(function(n){t[n.name]=e.expense[n.name]}),n({method:"POST",url:"/api/createExpense",headers:{"Content-Type":"application/json"},data:t}).then(function(){e.deleteExpense()}).catch(function(e){console.error(e)})}else n({method:"POST",url:"/api/updateExpense",headers:{"Content-Type":"application/json"},data:e.expense}).then(function(){o.refreshExpenses().then(function(){e.goTo("/viewAll")})}).catch(function(e){console.error(e)})}}]),budgetApp.controller("CreationController",["$scope","$location","$http","schemas",function(e,t,n,a){e.recurrence=void 0,e.globalFields=a.getSchema("globalFields"),e.recurrenceTypes=a.getSchema("recurrenceTypes"),e.goTo=function(e){t.path(e)},e.updateFields=function(t){e.calculatedFields=a.getCalculatedFields(t)},e.saveExpense=function(){var t={recurrence:e.recurrence,creationDate:(new Date).toISOString()};e.globalFields.forEach(function(e){t[e.name]=e.value}),e.calculatedFields.fields.forEach(function(e){t[e.name]=e.value}),n({method:"POST",url:"/api/createExpense",headers:{"Content-Type":"application/json"},data:t}).then(function(){e.goTo("/")}).catch(function(e){console.error(e)})}}]);var budgetApp=angular.module("budgetApp"),budgetApp=angular.module("budgetApp");budgetApp.service("expensesService",["$http","$q",function(e,t){var n=this;this.refreshExpenses=function(){return e.get("/api/getAllExpenses").then(function(e){return n.expenses=e.data,n.expenses})},this.getExpenses=function(){return n.expenses?t.when(n.expenses):n.refreshExpenses()},this.getFilteredExpenses=function(n){return n?/\d{4}-\d{2}-\d{2}/.test(n)?e.get("/api/getExpensesStarting/"+n).then(function(e){return e.data}):t.reject("Invalid date format. Must follow the format YYYY-MM-DD"):e.get("/api/getExpensesThisPaycheck").then(function(e){return e.data})},this.getExpense=function(e,a,o){var r=t.defer(),c=_.find(n.expenses,function(t){return t.recurrence===e&&t.creationDate===a});return c?r.resolve(c):o?r.reject("Expense not found in refreshed expense list"):n.refreshExpenses().then(function(){r.resolve(n.getExpense(e,a,!0))}),r.promise}}]),budgetApp.service("schemas",function(){var e={};this.getSchema=function(t){return _.cloneDeep(e[t])},this.getSchemas=function(t){var n={};return t.forEach(function(t){n[t]=_.cloneDeep(e[t])}),n},this.getCalculatedFields=function(t){return _.find(e.recurrenceTypes,function(e){return e.name===t})},e.globalFields=[{name:"amount",type:"number",step:"0.01",value:void 0},{name:"payee",type:"text",value:void 0},{name:"purpose",type:"text",value:void 0}],e.recurrenceTypes=[{name:"paycheck",fields:[]},{name:"monthly",fields:[{name:"day_of_month",type:"number",step:"1",value:void 0}]},{name:"monthly-on",fields:[{name:"day_of_week",options:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],value:void 0},{name:"which",type:"number",step:"1",value:void 0}]},{name:"yearly",fields:[{name:"day_of_month",type:"number",step:"1",value:void 0},{name:"month",options:["January","February","March","April","May","June","July","August","September","October","November","December"],value:void 0}]},{name:"one-off",fields:[{name:"date",type:"date",value:void 0},{name:"paid",type:"checkbox",value:!1}]}]});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFwcC1jb250cm9sbGVycy5qcyIsImFwcC1kaXJlY3RpdmVzLmpzIiwiYXBwLXNlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJidWRnZXRBcHAiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkaHR0cCIsImV4cGVuc2VzU2VydmljZSIsImdvVG8iLCJwYXRoIiwicmVmcmVzaEV4cGVuc2VzIiwidGhlbiIsImdldEZpbHRlcmVkRXhwZW5zZXMiLCJleHBlbnNlRGF0YSIsImV4cGVuc2VzIiwicGF5Y2hlY2tTdGFydCIsIkRhdGUiLCJwYXljaGVja0VuZCIsImdldCIsInJlcyIsInJlbWFpbmluZ1BheSIsImRhdGEiLCJJdGVtIiwibGVmdG92ZXJBbXQiLCJuZXRQYXkiLCJwYXljaGVja0FtdCIsInJlY2FsY3VsYXRlVG90YWwiLCJ1cGRhdGVQYXljaGVjayIsImZvcm1hdHRlZERhdGUiLCJtb21lbnQiLCJmb3JtYXQiLCJ0b3RhbCIsInJlZHVjZSIsInByZXYiLCJjdXJyZW50IiwicGFyc2VGbG9hdCIsImFtb3VudCIsInJlY3VycmVuY2UiLCJjcmVhdGlvbkRhdGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJnZXRFeHBlbnNlcyIsIiRyb3V0ZVBhcmFtcyIsInNjaGVtYXMiLCJnbG9iYWxGaWVsZHMiLCJnZXRTY2hlbWEiLCJyZWN1cnJlbmNlVHlwZXMiLCJjYWxjdWxhdGVkRmllbGRzIiwiZ2V0Q2FsY3VsYXRlZEZpZWxkcyIsImdldEV4cGVuc2UiLCJkZWNvZGVVUklDb21wb25lbnQiLCJleHBlbnNlIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJ1cGRhdGVGaWVsZHMiLCJkZWxldGVFeHBlbnNlIiwibWV0aG9kIiwidXJsIiwiaGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsInByaW1hcnkiLCJzZWNvbmRhcnkiLCJ1cGRhdGVFeHBlbnNlIiwiZmluYWxPYmoiLCJmb3JFYWNoIiwiZmllbGQiLCJuYW1lIiwiZmllbGRzIiwidW5kZWZpbmVkIiwic2F2ZUV4cGVuc2UiLCJ0b0lTT1N0cmluZyIsInZhbHVlIiwic2VydmljZSIsIiRxIiwidGhpcyIsImRhdGUiLCJ0ZXN0IiwicmVqZWN0IiwicmVjdXJzaXZlIiwiZGVmZXJyZWQiLCJkZWZlciIsIl8iLCJmaW5kIiwicmVzb2x2ZSIsInByb21pc2UiLCJzY2hlbWEiLCJjbG9uZURlZXAiLCJnZXRTY2hlbWFzIiwic2NoZW1hQXJyYXkiLCJzY2hlbWFSZXR1cm4iLCJ0eXBlIiwic3RlcCIsIm9wdGlvbnMiXSwibWFwcGluZ3MiOiJBQUNBQSxRQUFBQyxPQUFBLGFBQUEsWUFDQUMsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxLQUFBLEtBQ0FDLFlBQUEsNkJBQ0FDLFdBQUEsd0JBQ0FGLEtBQUEsWUFDQUMsWUFBQSx1QkFDQUMsV0FBQSwwQkFDQUYsS0FBQSxtQ0FDQUMsWUFBQSx3QkFDQUMsV0FBQSx1QkFDQUYsS0FBQSxjQUNBQyxZQUFBLHVCQUNBQyxXQUFBLHlCQ2RBLElBQUFDLFdBQUFQLFFBQUFDLE9BQUEsWUFFQU0sV0FBQUQsV0FBQSx1QkFBQSxTQUFBLFlBQUEsUUFBQSxrQkFBQSxTQUFBRSxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBSCxFQUFBSSxLQUFBLFNBQUFDLEdBQ0FKLEVBQUFJLEtBQUFBLElBR0FGLEVBQUFHLGtCQUFBQyxLQUFBLFdBQ0FKLEVBQUFLLHNCQUFBRCxLQUFBLFNBQUFFLEdBQ0FULEVBQUFVLFNBQUFELEVBQUFDLFNBQ0FWLEVBQUFXLGNBQUEsR0FBQUMsTUFBQUgsRUFBQUUsZUFDQVgsRUFBQWEsWUFBQSxHQUFBRCxNQUFBSCxFQUFBSSxhQUNBWCxFQUFBWSxJQUFBLDJDQUFBUCxLQUFBLFNBQUFRLEdBQ0FmLEVBQUFnQixhQUFBRCxFQUFBRSxLQUFBQyxLQUFBQyxZQUNBbkIsRUFBQW9CLE9BQUFMLEVBQUFF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QixFQUFBRyxrQkFFQXNCLEtBQUEsV0FDQUMsWUFHQUQsS0FBQSxVQUNBQyxTQUVBRCxLQUFBLGVBQ0F3QixLQUFBLFNBQ0FDLEtBQUEsSUFDQXBCLE1BQUFILFdBS0FGLEtBQUEsYUFDQUMsU0FFQUQsS0FBQSxjQUNBMEIsU0FDQSxTQUNBLFVBQ0EsWUFDQSxXQUNBLFNBQ0EsV0FDQSxVQUVBckIsTUFBQUgsU0FHQUYsS0FBQSxRQUNBd0IsS0FBQSxTQUNBQyxLQUFBLElBQ0FwQixNQUFBSCxXQUtBRixLQUFBLFNBQ0FDLFNBRUFELEtBQUEsZUFDQXdCLEtBQUEsU0FDQUMsS0FBQSxJQUNBcEIsTUFBQUgsU0FHQUYsS0FBQSxRQUNBMEIsU0FDQSxVQUNBLFdBQ0EsUUFDQSxRQUNBLE1BQ0EsT0FDQSxPQUNBLFNBQ0EsWUFDQSxVQUNBLFdBQ0EsWUFFQXJCLE1BQUFILFdBS0FGLEtBQUEsVUFDQUMsU0FFQUQsS0FBQSxPQUNBd0IsS0FBQSxPQUNBbkIsTUFBQUgsU0FHQUYsS0FBQSxPQUNBd0IsS0FBQSxXQUNBbkIsT0FBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbmFuZ3VsYXIubW9kdWxlKCdidWRnZXRBcHAnLCBbJ25nUm91dGUnXSlcbi5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCB7XG5cdFx0dGVtcGxhdGVVcmw6ICcvdGVtcHMvZnJvbnRQYWdlLnRlbXAuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ0Zyb250UGFnZUNvbnRyb2xsZXInXG5cdH0pLndoZW4oJy92aWV3QWxsJywge1xuXHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBzL2FsbC50ZW1wLmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdWaWV3QWxsUGFnZUNvbnRyb2xsZXInXG5cdH0pLndoZW4oJy9lZGl0LzpyZWN1cnJlbmNlLzpjcmVhdGlvbkRhdGUnLCB7XG5cdFx0dGVtcGxhdGVVcmw6ICcvdGVtcHMvZWRpdC50ZW1wLmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdFZGl0UGFnZUNvbnRyb2xsZXInXG5cdH0pLndoZW4oJy9jcmVhdGVOZXcnLCB7XG5cdFx0dGVtcGxhdGVVcmw6ICcvdGVtcHMvbmV3LnRlbXAuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ0NyZWF0aW9uQ29udHJvbGxlcidcblx0fSk7XG59KTtcbiIsIi8qIGdsb2JhbCBhbmd1bGFyLCBfLCBtb21lbnQgKi9cbnZhciBidWRnZXRBcHAgPSBhbmd1bGFyLm1vZHVsZSgnYnVkZ2V0QXBwJyk7XG5cbmJ1ZGdldEFwcC5jb250cm9sbGVyKCdGcm9udFBhZ2VDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgJ2V4cGVuc2VzU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCAkaHR0cCwgZXhwZW5zZXNTZXJ2aWNlKSB7XG5cdCRzY29wZS5nb1RvID0gZnVuY3Rpb24ocGF0aCkge1xuXHRcdCRsb2NhdGlvbi5wYXRoKHBhdGgpO1xuXHR9O1xuXG5cdGV4cGVuc2VzU2VydmljZS5yZWZyZXNoRXhwZW5zZXMoKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdGV4cGVuc2VzU2VydmljZS5nZXRGaWx0ZXJlZEV4cGVuc2VzKCkudGhlbihmdW5jdGlvbihleHBlbnNlRGF0YSkge1xuXHRcdFx0JHNjb3BlLmV4cGVuc2VzID0gZXhwZW5zZURhdGEuZXhwZW5zZXM7XG5cdFx0XHQkc2NvcGUucGF5Y2hlY2tTdGFydCA9IG5ldyBEYXRlKGV4cGVuc2VEYXRhLnBheWNoZWNrU3RhcnQpO1xuXHRcdFx0JHNjb3BlLnBheWNoZWNrRW5kID0gbmV3IERhdGUoZXhwZW5zZURhdGEucGF5Y2hlY2tFbmQpO1xuXHRcdFx0JGh0dHAuZ2V0KCcvYXBpL2dldEV4cGVuc2Uvc3lzdGVtL3BheWNoZWNrLWFjdHVhbHMnKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHQkc2NvcGUucmVtYWluaW5nUGF5ID0gcmVzLmRhdGEuSXRlbS5sZWZ0b3ZlckFtdDtcblx0XHRcdFx0JHNjb3BlLm5ldFBheSA9IHJlcy5kYXRhLkl0ZW0ucGF5Y2hlY2tBbXQ7XG5cdFx0XHRcdCRzY29wZS5yZWNhbGN1bGF0ZVRvdGFsKCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSk7XG5cblx0JHNjb3BlLnVwZGF0ZVBheWNoZWNrID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGZvcm1hdHRlZERhdGUgPSBtb21lbnQoJHNjb3BlLnBheWNoZWNrU3RhcnQpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xuXHRcdGV4cGVuc2VzU2VydmljZS5nZXRGaWx0ZXJlZEV4cGVuc2VzKGZvcm1hdHRlZERhdGUpLnRoZW4oZnVuY3Rpb24oZXhwZW5zZURhdGEpIHtcblx0XHRcdCRzY29wZS5leHBlbnNlcyA9IGV4cGVuc2VEYXRhLmV4cGVuc2VzO1xuXHRcdFx0JHNjb3BlLnBheWNoZWNrU3RhcnQgPSBleHBlbnNlRGF0YS5wYXljaGVja1N0YXJ0O1xuXHRcdFx0JHNjb3BlLnBheWNoZWNrRW5kID0gZXhwZW5zZURhdGEucGF5Y2hlY2tFbmQ7XG5cdFx0XHQkc2NvcGUucmVjYWxjdWxhdGVUb3RhbCgpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdCRzY29wZS5yZWNhbGN1bGF0ZVRvdGFsID0gZnVuY3Rpb24oKSB7XG5cdFx0JHNjb3BlLnRvdGFsID0gJHNjb3BlLmV4cGVuc2VzLnJlZHVjZShmdW5jdGlvbihwcmV2LCBjdXJyZW50KSB7XG5cdFx0XHRyZXR1cm4gcHJldiArIHBhcnNlRmxvYXQoY3VycmVudC5hbW91bnQpO1xuXHRcdH0sIHBhcnNlRmxvYXQoJHNjb3BlLmV4cGVuc2VzWzBdLmFtb3VudCkpO1xuXHRcdCRzY29wZS50b3RhbCAtPSAkc2NvcGUucmVtYWluaW5nUGF5O1xuXHR9O1xufV0pO1xuXG5idWRnZXRBcHAuY29udHJvbGxlcignVmlld0FsbFBhZ2VDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ2V4cGVuc2VzU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBleHBlbnNlc1NlcnZpY2UpIHtcblx0JHNjb3BlLmdvVG8gPSBmdW5jdGlvbihwYXRoLCByZWN1cnJlbmNlLCBjcmVhdGlvbkRhdGUpIHtcblx0XHRpZihwYXRoID09PSAnZWRpdCcpIHtcblx0XHRcdCRsb2NhdGlvbi5wYXRoKHBhdGggKyAnLycgKyByZWN1cnJlbmNlICsgJy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGNyZWF0aW9uRGF0ZSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkbG9jYXRpb24ucGF0aChwYXRoKTtcblx0XHR9XG5cdH07XG5cblx0ZXhwZW5zZXNTZXJ2aWNlLmdldEV4cGVuc2VzKCkudGhlbihmdW5jdGlvbihleHBlbnNlcykge1xuXHRcdCRzY29wZS5leHBlbnNlcyA9IGV4cGVuc2VzO1xuXHR9KTtcbn1dKTtcblxuYnVkZ2V0QXBwLmNvbnRyb2xsZXIoJ0VkaXRQYWdlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsICckcm91dGVQYXJhbXMnLCAnZXhwZW5zZXNTZXJ2aWNlJywgJ3NjaGVtYXMnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgJGh0dHAsICRyb3V0ZVBhcmFtcywgZXhwZW5zZXNTZXJ2aWNlLCBzY2hlbWFzKSB7XG5cdHZhciByZWN1cnJlbmNlID0gJHJvdXRlUGFyYW1zLnJlY3VycmVuY2U7XG5cdHZhciBjcmVhdGlvbkRhdGUgPSAkcm91dGVQYXJhbXMuY3JlYXRpb25EYXRlO1xuXG5cdCRzY29wZS5nb1RvID0gZnVuY3Rpb24ocGF0aCkge1xuXHRcdCRsb2NhdGlvbi5wYXRoKHBhdGgpO1xuXHR9O1xuXG5cdCRzY29wZS5nbG9iYWxGaWVsZHMgPSBzY2hlbWFzLmdldFNjaGVtYSgnZ2xvYmFsRmllbGRzJyk7XG5cdCRzY29wZS5yZWN1cnJlbmNlVHlwZXMgPSBzY2hlbWFzLmdldFNjaGVtYSgncmVjdXJyZW5jZVR5cGVzJyk7XG5cdCRzY29wZS5jYWxjdWxhdGVkRmllbGRzID0gc2NoZW1hcy5nZXRDYWxjdWxhdGVkRmllbGRzKHJlY3VycmVuY2UpO1xuXG5cdGV4cGVuc2VzU2VydmljZS5nZXRFeHBlbnNlKHJlY3VycmVuY2UsIGRlY29kZVVSSUNvbXBvbmVudChjcmVhdGlvbkRhdGUpKS50aGVuKGZ1bmN0aW9uKGV4cGVuc2UpIHtcblx0XHQkc2NvcGUuZXhwZW5zZSA9IGV4cGVuc2UgfHwgbnVsbDtcblx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHR9KTtcblxuXHQkc2NvcGUudXBkYXRlRmllbGRzID0gZnVuY3Rpb24oKSB7XG5cdFx0JHNjb3BlLmNhbGN1bGF0ZWRGaWVsZHMgPSBzY2hlbWFzLmdldENhbGN1bGF0ZWRGaWVsZHMoJHNjb3BlLmV4cGVuc2UucmVjdXJyZW5jZSk7XG5cdH07XG5cblx0JHNjb3BlLmRlbGV0ZUV4cGVuc2UgPSBmdW5jdGlvbigpIHtcblx0XHQkaHR0cCh7XG5cdFx0XHRtZXRob2Q6ICdERUxFVEUnLFxuXHRcdFx0dXJsOiAnL2FwaS9kZWxldGVFeHBlbnNlJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGRhdGE6IHtcblx0XHRcdFx0cHJpbWFyeTogcmVjdXJyZW5jZSxcblx0XHRcdFx0c2Vjb25kYXJ5OiBkZWNvZGVVUklDb21wb25lbnQoY3JlYXRpb25EYXRlKVxuXHRcdFx0fVxuXHRcdH0pLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHRleHBlbnNlc1NlcnZpY2UucmVmcmVzaEV4cGVuc2VzKCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdFx0JHNjb3BlLmdvVG8oJy92aWV3QWxsJyk7XG5cdFx0XHR9KTtcblx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHR9KTtcblx0fTtcblxuXHQkc2NvcGUudXBkYXRlRXhwZW5zZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmKHJlY3VycmVuY2UgIT09ICRzY29wZS5leHBlbnNlLnJlY3VycmVuY2UpIHtcblx0XHRcdHZhciBmaW5hbE9iaiA9IHtcblx0XHRcdFx0cmVjdXJyZW5jZTogJHNjb3BlLmV4cGVuc2UucmVjdXJyZW5jZSxcblx0XHRcdFx0Y3JlYXRpb25EYXRlOiBjcmVhdGlvbkRhdGVcblx0XHRcdH07XG5cdFx0XHQkc2NvcGUuZ2xvYmFsRmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdFx0ZmluYWxPYmpbZmllbGQubmFtZV0gPSAkc2NvcGUuZXhwZW5zZVtmaWVsZC5uYW1lXTtcblx0XHRcdH0pO1xuXHRcdFx0JHNjb3BlLmNhbGN1bGF0ZWRGaWVsZHMuZmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdFx0ZmluYWxPYmpbZmllbGQubmFtZV0gPSAkc2NvcGUuZXhwZW5zZVtmaWVsZC5uYW1lXTtcblx0XHRcdH0pO1xuXHRcdFx0JGh0dHAoe1xuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0dXJsOiAnL2FwaS9jcmVhdGVFeHBlbnNlJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0fSxcblx0XHRcdFx0ZGF0YTogZmluYWxPYmpcblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCRzY29wZS5kZWxldGVFeHBlbnNlKCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCRodHRwKHtcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdHVybDogJy9hcGkvdXBkYXRlRXhwZW5zZScsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGRhdGE6ICRzY29wZS5leHBlbnNlXG5cdFx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRleHBlbnNlc1NlcnZpY2UucmVmcmVzaEV4cGVuc2VzKCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkc2NvcGUuZ29UbygnL3ZpZXdBbGwnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xufV0pO1xuXG5idWRnZXRBcHAuY29udHJvbGxlcignQ3JlYXRpb25Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgJ3NjaGVtYXMnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgJGh0dHAsIHNjaGVtYXMpIHtcblx0JHNjb3BlLnJlY3VycmVuY2UgPSB1bmRlZmluZWQ7XG5cdCRzY29wZS5nbG9iYWxGaWVsZHMgPSBzY2hlbWFzLmdldFNjaGVtYSgnZ2xvYmFsRmllbGRzJyk7XG5cdCRzY29wZS5yZWN1cnJlbmNlVHlwZXMgPSBzY2hlbWFzLmdldFNjaGVtYSgncmVjdXJyZW5jZVR5cGVzJyk7XG5cblx0JHNjb3BlLmdvVG8gPSBmdW5jdGlvbihwYXRoKSB7XG5cdFx0JGxvY2F0aW9uLnBhdGgocGF0aCk7XG5cdH07XG5cblx0JHNjb3BlLnVwZGF0ZUZpZWxkcyA9IGZ1bmN0aW9uKHJlY3VycmVuY2UpIHtcblx0XHQkc2NvcGUuY2FsY3VsYXRlZEZpZWxkcyA9IHNjaGVtYXMuZ2V0Q2FsY3VsYXRlZEZpZWxkcyhyZWN1cnJlbmNlKTtcblx0fTtcblxuXHQkc2NvcGUuc2F2ZUV4cGVuc2UgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgZmluYWxPYmogPSB7XG5cdFx0XHRyZWN1cnJlbmNlOiAkc2NvcGUucmVjdXJyZW5jZSxcblx0XHRcdGNyZWF0aW9uRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG5cdFx0fTtcblx0XHQkc2NvcGUuZ2xvYmFsRmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdGZpbmFsT2JqW2ZpZWxkLm5hbWVdID0gZmllbGQudmFsdWU7XG5cdFx0fSk7XG5cdFx0JHNjb3BlLmNhbGN1bGF0ZWRGaWVsZHMuZmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdGZpbmFsT2JqW2ZpZWxkLm5hbWVdID0gZmllbGQudmFsdWU7XG5cdFx0fSk7XG5cblx0XHQkaHR0cCh7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdHVybDogJy9hcGkvY3JlYXRlRXhwZW5zZScsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRkYXRhOiBmaW5hbE9ialxuXHRcdH0pLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHQkc2NvcGUuZ29UbygnLycpO1xuXHRcdH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdH0pO1xuXHR9O1xufV0pO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbnZhciBidWRnZXRBcHAgPSBhbmd1bGFyLm1vZHVsZSgnYnVkZ2V0QXBwJyk7XG4iLCIvKiBnbG9iYWwgYW5ndWxhciwgXywgbW9tZW50ICovXG52YXIgYnVkZ2V0QXBwID0gYW5ndWxhci5tb2R1bGUoJ2J1ZGdldEFwcCcpO1xuXG5idWRnZXRBcHAuc2VydmljZSgnZXhwZW5zZXNTZXJ2aWNlJywgWyAnJGh0dHAnLCAnJHEnLCBmdW5jdGlvbigkaHR0cCwgJHEpIHtcblx0dmFyIHNlcnZpY2UgPSB0aGlzO1xuXG5cdHRoaXMucmVmcmVzaEV4cGVuc2VzID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9nZXRBbGxFeHBlbnNlcycpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRzZXJ2aWNlLmV4cGVuc2VzID0gcmVzLmRhdGE7XG5cdFx0XHRyZXR1cm4gc2VydmljZS5leHBlbnNlcztcblx0XHR9KTtcblx0fTtcblxuXHR0aGlzLmdldEV4cGVuc2VzID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYoIXNlcnZpY2UuZXhwZW5zZXMpIHsgcmV0dXJuIHNlcnZpY2UucmVmcmVzaEV4cGVuc2VzKCk7IH1cblx0XHRyZXR1cm4gJHEud2hlbihzZXJ2aWNlLmV4cGVuc2VzKTtcblx0fTtcblxuXHR0aGlzLmdldEZpbHRlcmVkRXhwZW5zZXMgPSBmdW5jdGlvbihkYXRlKSB7XG5cdFx0aWYoIWRhdGUpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZ2V0RXhwZW5zZXNUaGlzUGF5Y2hlY2snKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYoL1xcZHs0fS1cXGR7Mn0tXFxkezJ9Ly50ZXN0KGRhdGUpKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2dldEV4cGVuc2VzU3RhcnRpbmcvJyArIGRhdGUpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gJHEucmVqZWN0KCdJbnZhbGlkIGRhdGUgZm9ybWF0LiBNdXN0IGZvbGxvdyB0aGUgZm9ybWF0IFlZWVktTU0tREQnKTtcblx0XHR9XG5cdH07XG5cblx0dGhpcy5nZXRFeHBlbnNlID0gZnVuY3Rpb24ocHJpbWFyeSwgc2Vjb25kYXJ5LCByZWN1cnNpdmUpIHtcblx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXHRcdHZhciBleHBlbnNlID0gXy5maW5kKHNlcnZpY2UuZXhwZW5zZXMsIGZ1bmN0aW9uKGV4cGVuc2UpIHtcblx0XHRcdHJldHVybiBleHBlbnNlLnJlY3VycmVuY2UgPT09IHByaW1hcnkgJiYgZXhwZW5zZS5jcmVhdGlvbkRhdGUgPT09IHNlY29uZGFyeTtcblx0XHR9KTtcblxuXHRcdGlmICghZXhwZW5zZSkge1xuXHRcdFx0aWYocmVjdXJzaXZlKSB7IGRlZmVycmVkLnJlamVjdCgnRXhwZW5zZSBub3QgZm91bmQgaW4gcmVmcmVzaGVkIGV4cGVuc2UgbGlzdCcpOyB9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0c2VydmljZS5yZWZyZXNoRXhwZW5zZXMoKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGRlZmVycmVkLnJlc29sdmUoc2VydmljZS5nZXRFeHBlbnNlKHByaW1hcnksIHNlY29uZGFyeSwgdHJ1ZSkpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShleHBlbnNlKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblx0fTtcbn1dKTtcblxuYnVkZ2V0QXBwLnNlcnZpY2UoJ3NjaGVtYXMnLCBmdW5jdGlvbigpIHtcblx0dmFyIHNjaGVtYXMgPSB7fTtcblxuXHR0aGlzLmdldFNjaGVtYSA9IGZ1bmN0aW9uKHNjaGVtYSkge1xuXHRcdHJldHVybiBfLmNsb25lRGVlcChzY2hlbWFzW3NjaGVtYV0pO1xuXHR9O1xuXG5cdHRoaXMuZ2V0U2NoZW1hcyA9IGZ1bmN0aW9uKHNjaGVtYUFycmF5KSB7XG5cdFx0dmFyIHNjaGVtYVJldHVybiA9IHt9O1xuXHRcdHNjaGVtYUFycmF5LmZvckVhY2goZnVuY3Rpb24oc2NoZW1hKSB7XG5cdFx0XHRzY2hlbWFSZXR1cm5bc2NoZW1hXSA9IF8uY2xvbmVEZWVwKHNjaGVtYXNbc2NoZW1hXSk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHNjaGVtYVJldHVybjtcblx0fTtcblxuXHR0aGlzLmdldENhbGN1bGF0ZWRGaWVsZHMgPSBmdW5jdGlvbihyZWN1cnJlbmNlKSB7XG5cdFx0cmV0dXJuIF8uZmluZChzY2hlbWFzLnJlY3VycmVuY2VUeXBlcywgZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0cmV0dXJuIHR5cGUubmFtZSA9PT0gcmVjdXJyZW5jZTtcblx0XHR9KTtcblx0fTtcblxuXHRzY2hlbWFzLmdsb2JhbEZpZWxkcyA9IFtcblx0XHR7XG5cdFx0XHRuYW1lOidhbW91bnQnLFxuXHRcdFx0dHlwZTogJ251bWJlcicsXG5cdFx0XHRzdGVwOiAnMC4wMScsXG5cdFx0XHR2YWx1ZTogdW5kZWZpbmVkXG5cdFx0fSxcblx0XHR7XG5cdFx0XHRuYW1lOidwYXllZScsXG5cdFx0XHR0eXBlOiAndGV4dCcsXG5cdFx0XHR2YWx1ZTogdW5kZWZpbmVkXG5cdFx0fSxcblx0XHR7XG5cdFx0XHRuYW1lOidwdXJwb3NlJyxcblx0XHRcdHR5cGU6ICd0ZXh0Jyxcblx0XHRcdHZhbHVlOiB1bmRlZmluZWRcblx0XHR9XG5cdF07XG5cblx0c2NoZW1hcy5yZWN1cnJlbmNlVHlwZXMgPSBbXG5cdFx0e1xuXHRcdFx0bmFtZToncGF5Y2hlY2snLFxuXHRcdFx0ZmllbGRzOiBbXVxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0bmFtZTonbW9udGhseScsXG5cdFx0XHRmaWVsZHM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG5hbWU6J2RheV9vZl9tb250aCcsXG5cdFx0XHRcdFx0dHlwZTogJ251bWJlcicsXG5cdFx0XHRcdFx0c3RlcDogJzEnLFxuXHRcdFx0XHRcdHZhbHVlOiB1bmRlZmluZWRcblx0XHRcdFx0fVxuXHRcdFx0XVxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0bmFtZTonbW9udGhseS1vbicsXG5cdFx0XHRmaWVsZHM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG5hbWU6J2RheV9vZl93ZWVrJyxcblx0XHRcdFx0XHRvcHRpb25zOiBbXG5cdFx0XHRcdFx0XHQnTW9uZGF5Jyxcblx0XHRcdFx0XHRcdCdUdWVzZGF5Jyxcblx0XHRcdFx0XHRcdCdXZWRuZXNkYXknLFxuXHRcdFx0XHRcdFx0J1RodXJzZGF5Jyxcblx0XHRcdFx0XHRcdCdGcmlkYXknLFxuXHRcdFx0XHRcdFx0J1NhdHVyZGF5Jyxcblx0XHRcdFx0XHRcdCdTdW5kYXknXG5cdFx0XHRcdFx0XSxcblx0XHRcdFx0XHR2YWx1ZTogdW5kZWZpbmVkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRuYW1lOid3aGljaCcsXG5cdFx0XHRcdFx0dHlwZTogJ251bWJlcicsXG5cdFx0XHRcdFx0c3RlcDogJzEnLFxuXHRcdFx0XHRcdHZhbHVlOiB1bmRlZmluZWRcblx0XHRcdFx0fVxuXHRcdFx0XVxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0bmFtZToneWVhcmx5Jyxcblx0XHRcdGZpZWxkczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bmFtZTonZGF5X29mX21vbnRoJyxcblx0XHRcdFx0XHR0eXBlOiAnbnVtYmVyJyxcblx0XHRcdFx0XHRzdGVwOiAnMScsXG5cdFx0XHRcdFx0dmFsdWU6IHVuZGVmaW5lZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bmFtZTonbW9udGgnLFxuXHRcdFx0XHRcdG9wdGlvbnM6IFtcblx0XHRcdFx0XHRcdCdKYW51YXJ5Jyxcblx0XHRcdFx0XHRcdCdGZWJydWFyeScsXG5cdFx0XHRcdFx0XHQnTWFyY2gnLFxuXHRcdFx0XHRcdFx0J0FwcmlsJyxcblx0XHRcdFx0XHRcdCdNYXknLFxuXHRcdFx0XHRcdFx0J0p1bmUnLFxuXHRcdFx0XHRcdFx0J0p1bHknLFxuXHRcdFx0XHRcdFx0J0F1Z3VzdCcsXG5cdFx0XHRcdFx0XHQnU2VwdGVtYmVyJyxcblx0XHRcdFx0XHRcdCdPY3RvYmVyJyxcblx0XHRcdFx0XHRcdCdOb3ZlbWJlcicsXG5cdFx0XHRcdFx0XHQnRGVjZW1iZXInXG5cdFx0XHRcdFx0XSxcblx0XHRcdFx0XHR2YWx1ZTogdW5kZWZpbmVkXG5cdFx0XHRcdH1cblx0XHRcdF1cblx0XHR9LFxuXHRcdHtcblx0XHRcdG5hbWU6J29uZS1vZmYnLFxuXHRcdFx0ZmllbGRzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRuYW1lOidkYXRlJyxcblx0XHRcdFx0XHR0eXBlOiAnZGF0ZScsXG5cdFx0XHRcdFx0dmFsdWU6IHVuZGVmaW5lZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bmFtZToncGFpZCcsXG5cdFx0XHRcdFx0dHlwZTogJ2NoZWNrYm94Jyxcblx0XHRcdFx0XHR2YWx1ZTogZmFsc2Vcblx0XHRcdFx0fVxuXHRcdFx0XVxuXHRcdH1cblx0XTtcbn0pO1xuIl19
